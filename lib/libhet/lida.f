




      FUNCTION LIDA(NSTA,GCLAT,ELONG)
      save
C   FOR A GIVEN IDA STATION NUMBER (AS RETURNED BY ROUTINE IDANUM),
C  RETURNS THE GEOCENTRIC COORDINATES OF THE STATION, AND FOR THE
C  FUNCTION ITSELF AN ERROR CODE.
C
C   CALLING PARAMETERS:
C
C     NSTA  - THE STATION NUMBER, AS GOTTEN FROM SUBROUTINE IDANUM.
C     GCLAT - THE GEOCENTRIC COLATITUDE, IN DEGREES, FOUND FOR A
C             FLATTENING OF 1/298.25 (CARRIED TO SECOND ORDER).
C             THE NORTH LATITUDE IS 90.-GCLAT.
C     ELONG - THE EAST LONGITUDE, IN DEGREES (BETWEEN + AND - 180)
C     LIDA  - THE FUNCTIONAL VALUE, SET TO 1 ON A SUCCESSFUL CALL,
C             -1 IF THE STATION NUMBER IS TOO LARGE.
C
C    >>>>>>>>>>>LAST UPDATED ON 22 JUNE 1983<<<<<<<<<<<
C
C  $$$$CALLS ONLY SYSTEM ROUTINES
C
C    AUTHOR - D. C. AGNEW, IGPP LA JOLLA
C
      DIMENSION LAT(3,23),LONG(3,23)
C  COORDINATES STORED IN DATA ARRAYS ARE THE GEOGRAPHIC LATITUDES AND
C  LONGITUDES, IN SEXAGESIMAL DEGREES.
      DATA NUMSTA/23/
      DATA LAT/   82,29,00,-15,39,50, 40,02,25,-35,19,15, 64,51,36,
     1 -27,09,29, 42,00,54, 55,19,00, 39,00,00, 13,32,18, 44,38,16,
     2  21,25,24, 25,08,54,-77,50,57,-11,59,15, 33,36,33,-21,12,45,
     3 -04,36,54, 18,06,34,-90,00,00, 45,16,45,-32,22,47,-35,01,57/
      DATA LONG/-62,24,00, -47,54,12, 116,10,30, 148,59,55,-147,50,06,
     1-109,26,04, 143,09,26, -3,12,18, 70,19,00, 144,54,42, -63,35,30,
     2-158,00,54, 102,44,49,166,40,02,-76,50,32,-116,27,19,-159,46,24,
     3  55,29,27, -66,09,00, 00,00,00,  4,32,31,  20,48,42, 138,34,41/
      DATA DR/.017453293/,FLT/298.25/
      IF(NSTA.GT.NUMSTA) GO TO 3
      LIDA = 1
      S = LAT(1,NSTA)/IABS(LAT(1,NSTA))
      W = LONG(1,NSTA)/IABS(LONG(1,NSTA))
      GCLAT = FLOAT(LAT(1,NSTA)) + S*((FLOAT(LAT(2,NSTA)) +
     1 (FLOAT(LAT(3,NSTA)))/60.)/60.)
      ELONG = FLOAT(LONG(1,NSTA)) + W*((FLOAT(LONG(2,NSTA)) +
     1 (FLOAT(LONG(3,NSTA)))/60.)/60.)
      GCLAT = DR*GCLAT
      E = 1./FLT
      W = SIN(GCLAT)
      S = ((2.-E)*W +4.*E*(W**3))*E*COS(GCLAT)
      GCLAT = (GCLAT-S)/DR
      GCLAT = 90.-GCLAT
      RETURN
 3    LIDA = -1
      RETURN
      END
