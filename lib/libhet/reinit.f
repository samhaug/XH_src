
C$**********************************************************************
      SUBROUTINE REINIT(PPERT,KPAR)
      save
      DOUBLE PRECISION Z1(1)
      INTEGER*4 IHTMDL(3)
      COMMON/SCAN/ PATH(204)
     1  ,IHTMDL,IFANM,LMAXM,LENY,NPRMM,PERTM(588),IFCC,MFIL(4),MFILAN(4)
      DIMENSION PPERT(24)
      COMMON/TAPE/ B(536),COMP(514),NPAR,NSOL,PERT(24),PRDMTX(300),
     1COLVEC(24),VAR2,FILLT(112),NBATCH
      EQUIVALENCE (ID,B(1)),(INST,B(3))
      COMMON/DBLEC/ EPLA,EPLON,DEP,TORG,DURT
      COMMON/BIGSPA/  X1(8740),X2(257,10),X3(24),X4(48),
     1X5(600),X6(300),X7(24),X8,X9,X10(24),X11(5344)
      EQUIVALENCE (X1(1),Z1(1))
      CALL STATN(ID,NAME,INST,STLAT,STLON,ILEV)
      DO 10 I=1,24
   10 PPERT(I)=0.
      IF(IFCC.EQ.0) GOTO 20
      CALL OCAV(EPLA,EPLON,STLAT,STLON,OCH,OCT,X1(1),X1(151))
      PPERT(1)=17.5329*((1.-OCT)-.62827*OCT)
      PPERT(KPAR+1)=17.5329*((1.-OCH)-.62827*OCH)
   20 IF(NPRMM.EQ.0) RETURN
      IH=1+2*(2*LMAXM+1)**2
      IT=IH+LENY
      IW1=IT+LENY
      IW2=IW1+LMAXM+3
      IW3=IW2+LMAXM+3
      ISAR=IW3+LMAXM+3
      CALL YLMAV(EPLA,EPLON,STLAT,STLON,LMAXM,X1(IH),X1(IT)
     1   ,X1(IW1),X1(IW2),X1(IW3),X1(ISAR),Z1)
      NP=MIN0(KPAR,NPRMM)
      DO 40 IP=1,NP
      IPK=IP+KPAR
      I1=LENY*(IP-1)
      KH=IH-1
      KT=IT-1
      DO 50 J1=1,LENY
      KH=1+KH
      KT=1+KT
      I1=1+I1
      PPERT(IP)=PPERT(IP)+X1(KT)*PERTM(I1)
      PPERT(IPK)=PPERT(IPK)+X1(KH)*PERTM(I1)
   50 CONTINUE
   40 CONTINUE
      RETURN
      END
